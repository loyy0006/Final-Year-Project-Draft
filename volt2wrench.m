function [FX,FY,FZ,TX,TY,TZ] = volt2wrench(V_X,V_Y,V_Z,VT_X,VT_Y,VT_Z)

%% Calibration matrix from Nano43 (FT32831)
%<FTSensor  Serial="FT32831" BodyStyle="Nano43" Family="DAQ" NumGages="6" CalFileVersion="1.1">
%	<Calibration  PartNumber="SI-36-0.5" CalDate="12/14/2020" ForceUnits="N" TorqueUnits="N-mm"...

% C = [  0.02098  -0.02876  -0.05237   4.51544  -0.05447  -4.46284 
%      -0.13719  -5.12368  -0.04217   2.58695   0.04008   2.52214 
%       2.97639  -0.01655   3.01180   0.02275   3.00141   0.01232 
%      -0.80475 -23.09345  43.58859  12.00245 -43.41431  11.27584 
%     -50.56376   0.53040  25.49010 -20.29579  25.13748  20.18422 
%      -1.25627 -38.28410   0.53176 -37.15623  -0.42516 -37.35515 ];
 
C = ...
  [-1.1120759756916572      0.50999763852046465  -1.2216734740484019     4.3675461136378564  -1.2255597732676613     -4.4825558815581523;
   -1.164263630332097      -4.3268373077705258   -1.2599605831706131     2.1589074068069523  -1.1812470022777437      2.1803838050305777;
    2.9330315367993318     -0.16131672952568415   3.0033217082531176     0.15410008254535251  2.9713801571474034      0.0027278552570141482;
   -0.00851938390322918    -0.020721172569223015  0.037391164575710838   0.00978699738579358 -0.054258051366685579    0.010889922278189258;
   -0.047898080265426926   -0.0025054814205305895 0.031904702599989926  -0.021048255254588005 0.032334352596495433    0.022148022178840342;
    0.00090484596683638768 -0.040261052068847912  0.0019851867734158742 -0.037502738579011166 0.00068067737496549277 -0.039570950640686005];

intercepts = [-2.2756712271261117-8.74-0.7073; 4.8307475817223544-3.808-0.8137; 0.65459740858613658+24.6+0.7015; ...
              0.014138940234942965-1.316+0.00069-0.01647; 0.011476437598809208-2.675+0.01124; 0.008235707174440483-0.2386-0.002175; ];
        
wrench = C*[V_X,V_Y,V_Z,VT_X,VT_Y,VT_Z]';
wrench = wrench + intercepts;

%% Part (B). Tare weight from sensor
tare = [
-3.53951464019785
1.6950064121207
-3.24269213389687
-1.29858144445255
-2.66572672348475
-0.251462398563701
];

wrench = wrench - tare;

FX = wrench(1);
FY = wrench(2);
FZ = wrench(3);
TX = wrench(4);
TY = wrench(5);
TZ = wrench(6);

end